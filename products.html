<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Productos | El Tornillo Feliz</title>
  <link rel="stylesheet" href="assets/css/styles.css"/>
</head>
<body>
  <nav class="nav">
    <div class="container nav-inner">
      <a class="brand" href="index.html"><img src="assets/img/logo.svg" alt="logo"/><b>El Tornillo Feliz</b></a>
      <div class="spacer"></div>
      <a href="products.html" aria-current="page">Productos</a>
      <a href="services.html">Servicios</a>
      <a href="contact.html">Contacto</a>
      <a class="btn btn-ghost" href="contact.html#cotizacion">Cotización <span class="badge inline"><span data-quote-count>0</span></span></a>
    </div>
  </nav>

  <main class="container section">
    <h1>Catálogo</h1>
    <p class="mini">Explora por categoría o busca por nombre.</p>

    <div class="card" style="margin:14px 0">
      <div class="form-row">
        <div><label>Búsqueda</label><input id="q" placeholder="taladro, llave, cemento..."/></div>
        <div><label>Categoría</label>
          <select id="cat">
            <option value="all">Todas</option>
            <option value="herramientas">Herramientas</option>
            <option value="construccion">Construcción</option>
            <option value="electricidad">Electricidad</option>
            <option value="plomeria">Plomería</option>
            <option value="pinturas">Pinturas</option>
          </select>
        </div>
      </div>
    </div>

    <div id="list" class="grid"></div>

    <div class="alert"><b>Tip:</b> Agrega productos a “Cotización” y envíanos tu lista por WhatsApp.</div>
  </main>

  <footer class="footer">
    <div class="container">© <span data-year></span> El Tornillo Feliz.</div>
  </footer>

  <a id="waFab" class="fab-wa hidden" target="_blank" href="#">WhatsApp</a>

  <script src="assets/js/config.js"></script>
  <script src="assets/js/main.js"></script>
  <script>
    // Producto demo (inline para evitar problemas de CORS en file://)
    const PRODUCTS = [
      {id:1, name:"Taladro Percutor 1/2\"", price: 950, cat:"herramientas"},
      {id:2, name:"Juego de Llaves Mixtas (12 pzs)", price: 420, cat:"herramientas"},
      {id:3, name:"Sierra Circular 7-1/4\"", price: 1150, cat:"herramientas"},
      {id:4, name:"Cemento Portland 50kg", price: 105, cat:"construccion"},
      {id:5, name:"Varilla #3 (3/8\")", price: 42, cat:"construccion"},
      {id:6, name:"Cable THHN Cal. 12 (metro)", price: 5.5, cat:"electricidad"},
      {id:7, name:"Breaker 20A", price: 65, cat:"electricidad"},
      {id:8, name:"Tubo PVC 1/2\" (3m)", price: 28, cat:"plomeria"},
      {id:9, name:"Válvula Esférica 1/2\"", price: 48, cat:"plomeria"},
      {id:10, name:"Pintura Látex 1 Gl", price: 165, cat:"pinturas"},
      {id:11, name:"Brocha 2\"", price: 22, cat:"pinturas"}
    ];

    const list = document.getElementById("list");
    const q = document.getElementById("q");
    const cat = document.getElementById("cat");

    function render(items){
      list.innerHTML = "";
      items.forEach(p => {
        const el = document.createElement("div");
        el.className = "card col-4";
        el.innerHTML = `
          <div class="badge-cat">${p.cat}</div>
          <h3>${p.name}</h3>
          <p>Q ${p.price.toFixed(2)}</p>
          <div style="display:flex; gap:8px; margin-top:8px">
            <button class="btn btn-primary" data-id="${p.id}">Agregar a cotización</button>
            <button class="btn btn-ghost" data-id="${p.id}" data-buy>Comprar/Consultar</button>
          </div>`;
        list.appendChild(el);
      });
    }

    function filter(){
      const term = (q.value || "").toLowerCase().trim();
      const c = cat.value;
      const filtered = PRODUCTS.filter(p => {
        const okCat = c === "all" ? true : p.cat === c;
        const okQ = !term || p.name.toLowerCase().includes(term);
        return okCat && okQ;
      });
      render(filtered);
    }
    q.addEventListener("input", filter);
    cat.addEventListener("change", filter);

    list.addEventListener("click", (e)=>{
      const id = +e.target.dataset.id;
      if(!id) return;
      const item = PRODUCTS.find(p => p.id === id);
      if(e.target.hasAttribute("data-buy")){
        const text = `Hola, me interesa: ${item.name} (Q ${item.price.toFixed(2)})`;
        if(window.WHATSAPP_PHONE){
          location.href = `https://wa.me/${window.WHATSAPP_PHONE}?text=${encodeURIComponent(text)}`;
        } else alert("Configura el número de WhatsApp en assets/js/config.js");
      } else {
        addToQuote({id: item.id, name: item.name, price: item.price, qty: 1});
      }
    });

    // Initial
    filter();
  </script>
</body>
</html>
