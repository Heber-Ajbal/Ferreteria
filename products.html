<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Productos | El Tornillo Feliz</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/styles.css" />
    <script src="assets/js/sidebar.js" defer></script>
  </head>
  <body>
    <site-sidebar></site-sidebar>


    <main class="site-main container-fluid py-3">
      
      <h1 class="mb-1">Catálogo</h1>
      <p class="mini">Explora por categoría o busca por nombre.</p>
      

      <div class="card shadow-sm mb-3">
        <div class="card-body">
          <div class="row g-3 align-items-end">
            <div class="col-12 col-md-6 col-lg-4">
              <label for="q" class="form-label">Búsqueda</label>
              <input
                id="q"
                class="form-control"
                placeholder="taladro, llave, cemento..."
              />
            </div>
            <div class="col-12 col-md-6 col-lg-4">
              <label for="cat" class="form-label">Categoría</label>
              <select id="cat" class="form-select">
                <option value="all">Todas</option>
                <option value="herramientas">Herramientas</option>
                <option value="construccion">Construcción</option>
                <option value="electricidad">Electricidad</option>
                <option value="plomeria">Plomería</option>
                <option value="pinturas">Pinturas</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="alert mt-3">
        <b>Tip:</b> Agrega productos a “Cotización” y envíanos tu lista por
        WhatsApp.
      </div>

      <!-- Grid responsive Bootstrap -->
      <div id="list" class="row g-3 g-md-4"></div>

      
    </main>

    <a id="waFab" class="fab-wa hidden" target="_blank" href="#">WhatsApp</a>

    <script src="assets/js/config.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
      // Producto demo (inline para evitar problemas de CORS en file://)
      const PRODUCTS = [
        {
          id: 1,
          name: 'Taladro Percutor 1/2"',
          price: 950,
          cat: "herramientas",
          img: "assets/img/products/taladro.jpg",
          alt: "Taladro percutor de 1/2 pulgada",
        },
        {
          id: 2,
          name: "Juego de Llaves Mixtas (12 pzs)",
          price: 420,
          cat: "herramientas",
          img: "assets/img/products/llaves-mixtas.jpg",
          alt: "Juego de llaves mixtas 12 piezas",
        },
        {
          id: 3,
          name: 'Sierra Circular 7-1/4"',
          price: 1150,
          cat: "herramientas",
          img: "assets/img/products/sierra-circular.jpg",
        },
        {
          id: 4,
          name: "Cemento Portland 50kg",
          price: 105,
          cat: "construccion",
          img: "assets/img/products/cemento-50kg.jpg",
        },
        {
          id: 5,
          name: 'Varilla #3 (3/8")',
          price: 42,
          cat: "construccion",
          img: "assets/img/products/varilla-3-8.jpg",
        },
        {
          id: 6,
          name: "Cable THHN Cal. 12 (metro)",
          price: 5.5,
          cat: "electricidad",
          img: "assets/img/products/cable-thhn-12.jpg",
        },
        {
          id: 7,
          name: "Breaker 20A",
          price: 65,
          cat: "electricidad",
          img: "assets/img/products/breaker-20a.jpg",
        },
        {
          id: 8,
          name: 'Tubo PVC 1/2" (3m)',
          price: 28,
          cat: "plomeria",
          img: "assets/img/products/tubo-pvc-12.jpg",
        },
        {
          id: 9,
          name: 'Válvula Esférica 1/2"',
          price: 48,
          cat: "plomeria",
          img: "assets/img/products/valvula-esferica-12.jpeg",
        },
        {
          id: 10,
          name: "Pintura Látex 1 Gl",
          price: 165,
          cat: "pinturas",
          img: "assets/img/products/pintura-latex-1gl.jpg",
        },
        {
          id: 11,
          name: 'Brocha 2"',
          price: 22,
          cat: "pinturas",
          img: "assets/img/products/brocha-2.jpg",
        },
      ];

      const list = document.getElementById("list");
      const q = document.getElementById("q");
      const cat = document.getElementById("cat");

      // Placeholder embebido
      const PLACEHOLDER =
        'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop stop-color="%23e5e7eb"/><stop offset="1" stop-color="%23cbd5e1"/></linearGradient></defs><rect width="100%" height="100%" fill="url(%23g)"/><text x="50%" y="50%" font-family="Arial, Helvetica, sans-serif" font-size="24" fill="%239ca3af" text-anchor="middle" dominant-baseline="middle">Sin imagen</text></svg>';

      // Si la imagen local falla → intenta Unsplash por nombre/categoría → si falla, placeholder
      function fallbackImg(img) {
        if (img.dataset.tried === "2") {
          img.src = PLACEHOLDER;
          return;
        }
        if (img.dataset.tried === "1") {
          img.dataset.tried = "2";
          img.src = PLACEHOLDER;
          return;
        }
        img.dataset.tried = "1";
        const q =
          `${img.dataset.cat || ""} ${img.dataset.name || ""}`.trim() ||
          "hardware tools";
        img.src = `https://source.unsplash.com/800x600/?${encodeURIComponent(
          q
        )}`;
      }

      function render(items) {
        list.innerHTML = "";
        items.forEach((p) => {
          const col = document.createElement("div");
          col.className = "col-12 col-sm-6 col-lg-4 col-xxl-3";

          const src = p.img || PLACEHOLDER;
          const alt = p.alt || p.name;

          col.innerHTML = `
      <article class="product-card h-100">
        <span class="product-badge">${p.cat}</span>

        <div class="ratio ratio-4x3 product-thumb">
          <img
            loading="lazy"
            src="${src}"
            alt="${alt}"
            class="img-cover"
            data-name="${p.name}"
            data-cat="${p.cat}"
            onerror="fallbackImg(this)"
          >
        </div>

        <div class="p-3">
          <h3 class="product-title">${p.name}</h3>
          <p class="product-price mb-3">Q ${p.price.toFixed(2)}</p>
          <div class="d-flex gap-2">
            <button class="btn btn-primary btn-sm" data-id="${
              p.id
            }">Agregar a cotización</button>
            <button class="btn btn-outline-secondary btn-sm" data-id="${
              p.id
            }" data-buy>Comprar/Consultar</button>
          </div>
        </div>
      </article>
    `;
          list.appendChild(col);
        });
      }

      function filter() {
        const term = (q.value || "").toLowerCase().trim();
        const c = cat.value;
        const filtered = PRODUCTS.filter((p) => {
          const okCat = c === "all" ? true : p.cat === c;
          const okQ = !term || p.name.toLowerCase().includes(term);
          return okCat && okQ;
        });
        render(filtered);
      }
      q.addEventListener("input", filter);
      cat.addEventListener("change", filter);

      list.addEventListener("click", (e) => {
        const id = +e.target.dataset.id;
        if (!id) return;
        const item = PRODUCTS.find((p) => p.id === id);
        if (e.target.hasAttribute("data-buy")) {
          const text = `Hola, me interesa: ${item.name} (Q ${item.price.toFixed(
            2
          )})`;
          if (window.WHATSAPP_PHONE) {
            location.href = `https://wa.me/${
              window.WHATSAPP_PHONE
            }?text=${encodeURIComponent(text)}`;
          } else
            alert("Configura el número de WhatsApp en assets/js/config.js");
        } else {
          addToQuote({
            id: item.id,
            name: item.name,
            price: item.price,
            qty: 1,
          });
        }
      });

      // Initial
      filter();
    </script>

    <footer class="footer">
      <div class="footer-content">
        <div class="footer-brand">El Tornillo Feliz</div>

        <div class="footer-center">
          <div class="footer-copy">
            © 2025 El Tornillo Feliz. Todos los derechos reservados.
          </div>

          <div class="footer-social">
            <a
              href="https://facebook.com/tuferreteria"
              class="social-icon facebook"
              title="Facebook"
              target="_blank"
            ></a>
            <a
              href="https://instagram.com/tuferreteria"
              class="social-icon instagram"
              title="Instagram"
              target="_blank"
            ></a>
            <a
              href="https://tiktok.com/@tuferreteria"
              class="social-icon tiktok"
              title="TikTok"
              target="_blank"
            ></a>
            <a
              href="https://wa.me/502XXXXXXXX"
              class="social-icon whatsapp"
              title="WhatsApp"
              target="_blank"
            ></a>
            <a
              href="tel:+502XXXXXXXX"
              class="social-icon phone"
              title="Teléfono"
            ></a>
          </div>
        </div>

        <div class="footer-links">
          <a href="#privacidad">Privacidad</a>
          <a href="#terminos">Términos</a>
          <a href="#contacto">Contacto</a>
        </div>
      </div>
    </footer>    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
